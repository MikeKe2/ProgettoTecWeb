<html>

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta charset="utf-8">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
    integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <style>
    #feedback {
      font-size: 1.4em;
    }

    #selectablepublic .ui-selecting {
      background: #FECA40;
    }

    #selectablepublic .ui-selected {
      background: #F39814;
      color: white;
    }

    #selectablepublic {
      list-style-type: none;
      margin: 0;
      padding: 0;
      width: auto;
    }

    #selectablepublic li {
      margin: 3px;
      padding: 0.4em;
      font-size: 1.4em;
      height: 18px;
    }

    #selectableprivate .ui-selecting {
      background: #FECA40;
    }

    #selectableprivate .ui-selected {
      background: #F39814;
      color: white;
    }

    #selectableprivate {
      list-style-type: none;
      margin: 0;
      padding: 0;
      width: auto;
    }

    #selectableprivate li {
      margin: 3px;
      padding: 0.4em;
      font-size: 1.4em;
      height: 18px;
    }

    .ui-button {
      height: 2em;
      width: 80%;
    }
  </style>
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script>
    var selectedFiles = {
      files: []
    };
    var checkSel = undefined;

    function unselectFile(event, ui) {
      let i = selectedFiles.files.indexOf(ui.selected.getAttribute("name"));
      selectedFiles.files.splice(i, 1);
    }

    function publicSelected(event, ui) {
      if (checkSel == 0) selectedFiles.files = [];
      checkSel = 1;
      if (selectedFiles.files.indexOf(ui.selected.getAttribute("name")) == -1)
        selectedFiles.files.push(ui.selected.getAttribute("name"));
      $("#selectableprivate").selectable("destroy");
      $("#selectableprivate").selectable({
        selected: privateSelected,
        unselected: unselectFile
      });
    }

    function privateSelected(event, ui) {
      if (checkSel == 1) selectedFiles.files = [];
      checkSel = 0;
      if (selectedFiles.files.indexOf(ui.selected.getAttribute("name")) == -1)
        selectedFiles.files.push(ui.selected.getAttribute("name"));
      $("#selectablepublic").selectable("destroy");
      $("#selectablepublic").selectable({
        selected: publicSelected,
        unselected: unselectFile
      });
    }
    $(function () {
      $("#selectablepublic").selectable({
        selected: publicSelected,
        unselected: unselectFile
      });
      $("#selectableprivate").selectable({
        selected: privateSelected,
        unselected: unselectFile
      });
    });
  </script>
</head>


<body>
  <nav class="navbar navbar-light bg-light">
    <a href="#" class="navbar-brand mb-0 h1">Index</a>
    <a class="nav-link" href="/logout">Log out</a>
  </nav>

  <h1 class="display-4 text-center">Hello World</h1>
  <div class="container">
    <div class="row">
      <div class="col-sm">
        Public
      </div>
      <div class="col-sm">
      </div>
      <div class="col-sm">
        Private
      </div>
    </div>
    <div class="row">
      <div class="col-sm">
        <ol class="changepublic" id="selectablepublic"></ol>
      </div>
      <div class="col-sm btns">
        <ul style="list-style-type: none; margin: 0; padding: 0; width: auto;">
          <li><button class="ui-button ui-widget ui-corner-all ui-button-icon-only btn" onclick=mkPrivate()><span
                class="ui-icon ui-icon-arrowthick-1-e"></span></button></li>
          <li><button class="ui-button ui-widget ui-corner-all ui-button-icon-only btn" onclick=mkPublic()><span
                class="ui-icon ui-icon-arrowthick-1-w"></span></button></li>
        </ul>
      </div>
      <div class="col-sm">
        <ol class="changeprivate" id="selectableprivate"></ol>
      </div>
    </div>
  </div>
  <!--<table style="width: 100%;">
      <tr>
        <th>Public</th>
        <th></th>
        <th>Private</th>
      </tr>
      <tr>
        <td style="width: 45%;">
          <ol class="changepublic" id="selectablepublic"></ol>
        </td>
        <td class="btns" style="text-align: center; vertical-align: middle;">
          <ul style="list-style-type: none; margin: 0; padding: 0; width: auto;">
            <li><button class="ui-button ui-widget ui-corner-all ui-button-icon-only btn" onclick=mkPrivate()><span class="ui-icon ui-icon-arrowthick-1-e"></span></button></li>
            <li><button class="ui-button ui-widget ui-corner-all ui-button-icon-only btn" onclick=mkPublic()><span class="ui-icon ui-icon-arrowthick-1-w"></span></button></li>
          </ul>
        </td>
        <td style="width: 45%;">
          <ol class="changeprivate" id="selectableprivate"></ol>
        </td>    
      </tr>
    </table>-->
  <div class="container-fluid h-100">
    <div class="row align-items-center">
      <div class="col">
        <form action="/images" method="POST" enctype="multipart/form-data">
          <div class="form-group">
            <label for="form-control-file">Image file</label>
            <input class="form-control-file" name="my_images" type="file">
            <div>
              <input type="text">
            </div>
          </div>
          <input class="btn btn-outline-success" type="submit"></input>
        </form>
      </div>
      <div class="col">
        <form action="/audios" method="POST" enctype="multipart/form-data">
          <div class="form-group">
            <div>
              <label for="form-control-file">Audio file</label>
              <input class="form-control-file" name="my_audios" type="file">
            </div>
            <div>
              <input type="text">
            </div>
          </div>
          <input class="btn btn-outline-success" type="submit"></input>
        </form>
      </div>
      <div class="col">
        <form action="/widgets" method="POST" enctype="multipart/form-data">
          <div class="form-group">
            <div>
              <label for="form-control-file">Widgets file</label>
              <input class="form-control-file" name="my_widgets" type="file">
            </div>
            <div>
              <input type="text">
            </div>
          </div>
          <input class="btn btn-outline-success" type="submit"></input>
        </form>
      </div>
    </div>
  </div>
</body>
<script>
  if (window.localStorage.permanentData) {
    $("ol.change").replaceWith(window.localStorage.permanentData);
  }

  $(document).ready(function () {
    $.ajax({
        //change me for server (http://site181993.tw.cs.unibo.it) or localhost (http://localhost:8000)
        url: "http://localhost:8000/public",
        method: "POST",
      })
      .done(function (data) {
        /*localStorage.setItem("permanentData", data);
        var savedText = localStorage.getItem("permanentData");*/
        $("ol.changepublic").append(data);
        return;
      })
      .fail(function () {
        console.log("failed...");
        return;
      });

    $.ajax({
        //change me for server (http://site181993.tw.cs.unibo.it) or localhost (http://localhost:8000)
        url: "http://localhost:8000/private",
        method: "POST",
      })
      .done(function (data) {
        /*localStorage.setItem("permanentData", data);
        var savedText = localStorage.getItem("permanentData");*/
        $("ol.changeprivate").append(data);
        return;
      })
      .fail(function () {
        console.log("failed...");
        return;
      });
  });

  function mkPrivate() {
    $.ajax({
      url: "/makeprivate",
      method: "POST",
      async: false,
      data: selectedFiles,
      success: function (response) {
        window.location.href = window.location.href;
      }
    })
    selectedFiles.files = [];
  }

  function mkPublic() {
    $.ajax({
      url: "/makepublic",
      method: "POST",
      async: false,
      data: selectedFiles,
      success: function (response) {
        window.location.href = window.location.href;
      }
    })
    selectedFiles.files = [];
  }

  function gotoEditor(fileName, type) {
    window.location.href = "/editor/" + type + "/" + fileName;
  }
</script>
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
  integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

</html>